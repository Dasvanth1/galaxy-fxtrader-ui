<h2 mat-form-title class="ml-5">Configure Amount Tier </h2>

<form [formGroup]="configAmountTierForm" (ngSubmit)="onSubmit()">
  <div class="configAmountTierForm pb-4">
    
    <div class="flex-column">
      <mat-form-field appearance="outline" class="col-lg-3 mt-4 ml-4">
        <mat-label>Tier Name</mat-label>
        <input matInput formControlName="tierName">
        <mat-error *ngIf="!configAmountTierForm.get('tierName').value">Tier Name is required.</mat-error>
      </mat-form-field>
    </div>

    <h6 class="ml-5"><b>Tier Amount in terms of </b></h6>

    <div class="ml-3 mt-3">
      <mat-radio-group formControlName="inTermsOf">
        <mat-radio-button class="col-xl-auto" *ngFor="let tierAmount of tierAmounts" [value]="tierAmount.value"
          [class.selected-radio]="inTermsOf === tierAmount.value" (change)="inTermsOf = tierAmount.value">
          {{tierAmount.viewValue}}
        </mat-radio-button>
      </mat-radio-group>
    </div>

    <!-- AmountTier Range starts here. -->
    <div formArrayName="amountRanges">
      <div class="row mt-3 ml-3 col-form-label-sm col-md-12"
        *ngFor="let formGroup of amountTier.controls; let i = index" [formGroupName]="i">

        <mat-form-field appearance="outline" class="col-lg-2">
          <mat-label>From</mat-label>
          <input matInput formControlName="amountFrom" type="number">
          <mat-error *ngIf="formGroup.get('amountFrom').hasError('required')">From Amount is required.</mat-error>
          <mat-error *ngIf="formGroup.get('amountFrom').hasError('invalidFromAmountRange')">From Amount must be greater
            than last selected To Amount.</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="col-lg-2">
          <mat-label>To</mat-label>
          <input matInput formControlName="amountTo" type="number">
          <mat-error *ngIf="formGroup.get('amountTo').hasError('required')">To Amount is required.</mat-error>
          <mat-error *ngIf="formGroup.get('amountTo').hasError('invalidToAmountRange')">To Amount must be greater than
            From Amount.</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="col-lg-2">
          <mat-label>Bank Buys</mat-label>
          <div class="mat-input-with-buttons">
            <i class="fa fa-minus minus-icon" aria-hidden="true" (click)="decrement(formGroup, 'bankBuys')"></i>
            <input matInput formControlName="bankBuys" style="text-align: center;">
            <i class="fa fa-plus plus-icon" aria-hidden="true" (click)="increment(formGroup, 'bankBuys')"></i>
          </div>
          <mat-error *ngIf="formGroup.get('bankBuys').hasError('required')">Bank Buys is required.</mat-error>
          <mat-error *ngIf="formGroup.get('bankBuys').hasError('pattern')">Please enter a valid number.</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="col-lg-2">
          <mat-label>Bank Sells</mat-label>
          <div class="mat-input-with-buttons">
            <i class="fa fa-minus minus-icon" aria-hidden="true" (click)="decrement(formGroup, 'bankSells')"></i>
            <input matInput formControlName="bankSells" style="text-align: center;">
            <i class="fa fa-plus plus-icon" aria-hidden="true" (click)="increment(formGroup, 'bankSells')"></i>
          </div>
          <mat-error *ngIf="formGroup.get('bankSells').hasError('required')">Bank Sells is required.</mat-error>
          <mat-error *ngIf="formGroup.get('bankSells').hasError('pattern')">Please enter a valid number.</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="col-lg-2">
          <mat-label>Spread Units</mat-label>
          <mat-select formControlName="spreadUnit">
            <mat-option *ngFor="let spreadUnit of spreadUnits" [value]="spreadUnit.value">
              {{ spreadUnit.viewValue }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="formGroup.get('spreadUnit').hasError('required')">Spread Units is required.</mat-error>
        </mat-form-field>

        <button *ngIf="i !== 0" class="round-button mt-2" mat-icon-button (click)="removeAmountRangeRow(i)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width: 50%; height: 50%;">
            <polyline points="3 7 5 7 21 7" fill="none" stroke="#000" />
            <path d="M18.5,7l-1,14H6.5L5.5,7M8,7l.5-3.5h7L16,7" fill="none" stroke="#000" />
          </svg>
        </button>

      </div>
    </div>

    <div class="plusicon border rounded ml-5 col-10" (click)="addAmountRangeRow()">
      <i class="fa fa-plus" aria-hidden="true"></i>
    </div>
  </div>

  <div class="row col-10 ml-3 pt-4">
    <button mat-raised-button class="col-3 mat-btn-save" type="submit">Save</button>&nbsp; &nbsp;
    <button mat-raised-button class="col-3 mat-btn-cancel" (click)="cancel()">Cancel</button>&nbsp; &nbsp;
    <p mat-raised-button class="btn col-3 mat-btn-reset" (click)="resetForm()">Reset</p>
  </div>

</form>